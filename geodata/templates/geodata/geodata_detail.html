{% extends "geodata/geodata_bigmap_base.html" %}
{% load staticfiles %}
{% load i18n %}
{% load can_edit_geodata %}
{% load recommends_geodata %}


{% block extra_geodata_toolbox %}
    {% if user|can_edit_geodata:geodata %}
    <li>
      <a class="tooltip-geodata" title="{% trans "Edit" %}" href="{% url geodata_edit_url geodata.pk %}"><span class="glyphicon glyphicon-edit"></span> {% trans "Edit" %}</a>
    </li>
    <li>
      <a class="tooltip-geodata" title="{% trans "Delete" %}" href="{% url geodata_delete_url geodata.pk %}"><span class="glyphicon glyphicon-trash"></span> {% trans "Delete" %}</a>
    </li>
    {% endif %}
    <li>
    {% if user|recommends_geodata:geodata %}
      <a class="tooltip-geodata" title="{% trans "Recommend ON" %}" href="{% url geodata_recommend_url geodata.pk %}"><span class="glyphicon glyphicon-thumbs-up"></span> {% trans "Recommend ON" %}</a>
    {% else %}
      <a class="tooltip-geodata" title="{% trans "Recommend OFF" %}" href="{% url geodata_recommend_url geodata.pk %}"><span class="glyphicon glyphicon-thumbs-down"></span> {% trans "Recommend OFF" %}</a>
    {% endif %}
    </li>
{% endblock %}

{% block extra_extra_style %}
<link rel="stylesheet" href="{% static "css/blueimp-gallery.min.css" %}" type="text/css">
<link rel="stylesheet" href="{% static "css/bigmap.css" %}?v=1.2" type="text/css" />
<link rel="stylesheet" href="{% static "css/detail.css" %}?v=1.1" type="text/css" />
{% endblock %}

{% block extra_script %}
{{ block.super }}
<script type="text/javascript" src="{% static "js/blueimp-gallery.min.js" %}"></script>
<script type="text/javascript">
  document.getElementById('gallery').onclick = function (event) {
    event = event || window.event;
    var target = event.target || event.srcElement,
      link = target.src ? target.parentNode : target,
      options = {index: link, event: event,
                 slideshowInterval: 3000,
                 onclosed: function() {
                   var controlsClass = this.options.controlsClass;
                   if (!this.container.hasClass(controlsClass)) {
                       this.container.addClass(controlsClass);
                   }
                }},
      links = this.getElementsByTagName('a');
    blueimp.Gallery(links, options);
  };
</script>
{% endblock %}

{% block head_title %}{% block head_geodata_type %}{{ geodata_verbose_name }}{% endblock %}: {{ geodata.name }}{% endblock %}

{% block body_class %}place{% endblock %}

{% block body %}
{{ block.super }}
    <h1>{% block body_geodata_type %}{{ geodata_verbose_name }}{% endblock %}: {{ geodata.name }}</h1>

    {% block body_geodata_extra %}
    {% endblock %}

    {% if geodata.image.all %}
    <div>
      {% if geodata.image.all|length > 1 %}{% trans "Images" %}{% else %}{% trans "Image" %}{% endif %}:
      <div class="set" id="gallery">
        {% for image in geodata.image.all %}
        {% with image.thumbnail as im %}
        <a href="{{ image.display.url }}" title="{{ image.legend|escape }}"><img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" alt="" /></a>
        {% endwith %}
        {% endfor %}
      </div>
    </div>
    <div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls">
      <div class="slides"></div>
      <h3 class="title"></h3>
      <a class="prev"><span class="glyphicon glyphicon-chevron-left"></span></a>
      <a class="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
      <a class="close"><span class="glyphicon glyphicon-remove"></span></a>
      <a class="play-pause"></a>
      <ol class="indicator"></ol>
    </div>
    {% endif %}

    {% if geodata.description %}
    <div>
        {% trans "Description" %}:<br>
        {{ geodata.description }}
    </div>
    {% endif %}

    <div>
      {% trans "Contacts" %}:
      <ul>
          {% if geodata.credit_creator %}<li>{% trans "User" %}: <address><a href="{% url "profile_detail" geodata.creator %}">{{ geodata.creator }}</a></address></li>{% endif %}
          {% if geodata.url %}<li>{% trans "Website" %}: <a href={{ geodata.url }}>{{ geodata.url }}</a></li>{% endif %}
          {% if geodata.contact %}<li>{% trans "Other contact information" %}: <address>{{ geodata.contact }}</address></li>{% endif %}
      </ul>
    </div>
{% endblock %}
